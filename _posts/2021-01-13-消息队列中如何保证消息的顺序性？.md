#### 为什么有时要防止乱序场景？

我们借助Kafka将MySQL binlog同步到另一个数据库中时，数据量往往非常大。假如我们先后对一条数据增改删，从而产生了三条binlog，那么如果传输时乱序成了删增改，那么结果就错了。

#### 乱序场景是怎么产生的？

假如我们把同一个key的记录都发到同一个partition里，然后每个partition只用一个消费者来消费，那么我们拿到数据时是有序的。但是由于我们处理数据时较慢，不可能只用一个消费者来处理这个partition里的记录，而如果我们使用多个线程来处理这个消费者拉到的消息时，就可能乱序了。

#### 怎么解决乱序问题？

我们可以将消费者拉取的数据按不同的key放到不同的内存队列中，同一个key的消息放在同一个内存队列中，然后每个线程分别消费一个内存 队列即可。